---
layout:     post   				    # 使用的布局（不需要改）
title:      HMM 				# 标题 
subtitle:   Forward, Backward, EM, Viterbi           #副标题
date:       2019-10-01 				# 时间
author:     WYX 						# 作者
header-img: img/5.8.png 	#这篇文章标题背景图片
catalog: true 						# 是否归档
tags:								#标签
    - HMM

---



## 隐式马尔科夫模型 Hidden Markov Model 

<center>
    <img src = "https://github.com/joseph-mutu/Pics/raw/master/%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%8E%A8%E6%96%AD/HMM1.jpg" width = "300"/>
</center>

---

下述分析中

- 观测值为图上阴影部分，计为 $o_t \in {V_1,\ldots,V_T}$ 也就是 Markov 链长为 **T**
- 隐状态值为图上非阴影部分圆圈，计为 $i_t \in q_1,\ldots,q_N$ ，一共有 **N** 种可能的状态，每一个观测值都有可能从这 N 中状态中产生

----

HMM 模型存在两个假设

- 齐次马尔科夫假设，当前观察状态只与前一个状态有关


$$
P(i_t| i_{t-1},o_{t-1},\ldots, i_1,o_1) = P(i_t|i_{t-1})
$$


- 观测独立性假设，当前观测值仅与当前隐状态有关

$$
P(o_t|i_t,i_{1},\ldots,i_{t-1},o_{1},\ldots,o_{t-1}) = P(o_t|i_t)
$$



### 概率计算

目标为计算 $P(O|\lambda)$

其中 $\lambda$ 为模型参数：初始状态序列 $\pi$，转移概率矩阵 $A$ , 观测概率分布矩阵 $B$

$O$ 为观测概率序列，为 $o_1,o_2,\ldots, o_M$

#### Forward 

<center>
    <img src = "https://github.com/joseph-mutu/Pics/raw/master/%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%8E%A8%E6%96%AD/HMM2Forward.png" width = "300"/>
</center>

首先定义前向性概率如下:


$$
\alpha_t(i) = P(o_1,\ldots,o_t,i_t = q_i)
$$
$P(O|\lambda)$ 可以写为


$$
P(O|\lambda) = P(o_1,\ldots,o_T|\lambda) \\
= \sum \limits_{i=1}^N P(o_1,\ldots,o_T,i_t = qi|\lambda) \\
=  \sum \limits_{i=1}^N \alpha_T(q_i)
$$

##### 推导 $\alpha_{t+1}$ 与 $\alpha_t$ 之间的关系

$$
\alpha_{t+1}(j) = P(o_1,\ldots,o_{t+1},i_{t+1} = q_j |\lambda) \\
= \sum \limits_{i=1}^N P(o_1,\ldots,o_{t+1},i_{t+1} = q_j,i_t = q_i|\lambda)
= \sum \limits_{i=1}^N \underbrace{P(o_{t+1}|o_1,\ldots,o_{t},i_{t+1} = q_j,i_t = q_i;\lambda)}_{观测独立性假设} \\ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\times P(o_1,\ldots,o_{t},i_{t+1} = q_j,i_t = q_i|\lambda) \\
=  \sum \limits_{i=1}^N P(o_{t+1}|i_{t+1})P(o_1,\ldots,o_{t},i_{t+1} = q_j,i_t = q_i|\lambda) \\
= \sum \limits_{i=1}^N P(o_{t+1}|i_{t+1})\underbrace{P(i_{t+1} = q_j|o_1,\ldots,o_{t},,i_t = q_i;\lambda)}_{条件独立性假设} \\ ~~~~~~~~~~~~~~~~~~~~~~~~\times P(o_1,\ldots,o_{t},i_t = q_i|\lambda)  \\
= \sum \limits_{i=1}^N P(o_{t+1}|i_{t+1}) P(i_{t+1} = q_j|i_t = q_i;\lambda)\alpha_t(q_i) \\
= \sum \limits_{i=1}^N b_j(o_{t+1}) a_{ij}~\alpha_t(q_i) 
$$



前香型

#### Backward





### 模型参数估计



### 给定参数估计隐状态